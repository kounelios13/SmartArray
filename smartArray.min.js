function SmartArray(arr,byVal){var isJqueryPresent=typeof jQuery!="undefined";function int(i){return parseInt(i)}function shuffle(a){var j,x,i;i=a.length;while(i){j=Math.floor(Math.random()*i);x=a[i-1];a[i-1]=a[j];a[j]=x;i--}return a}function toChar(c){return String.fromCharCode(int(c))}function backup(){_backup=_array.slice()}function getArgs(a){return Array.prototype.slice.call(a)}function updateLength(arr){self.length=_array.length}function updateProps(deleteAll,append){var i;if(!append){for(i=0;i<self.length;i++)if(!deleteAll)self[i]=_array[i];else delete self[i]}else{for(i=_totalProps;i<_array.length;i++)self[i]=_array[i]}_totalProps=!deleteAll?_array.length:0}var self=this;var _array=arr||[],_backup=[];if(_array.constructor!=Array)_array=[];if(byVal&&_array.length>0)_array=arr.slice();var _totalProps=0;self.length=_array.length;updateProps();self.isEmpty=function(){return self.length==0};self.includes=function(){return Array.prototype.includes.apply(_array,getArgs(arguments))};self.every=function(){return Array.prototype.every.apply(_array,getArgs(arguments))};self.toChars=function(){var chars=[];for(var i=0,max=_array.length;i<max;i++)if(typeof _array[i]=="number")chars.push(toChar(_array[i]));return chars};self.getUniqueItems=function(sorted,sortFn){var unique_set=[];backup();self.sort();for(var i=0,max=_array.length;i<max;i+=self.frequency(_array[i]))if(!unique_set.includes(_array[i]))unique_set.push(_array[i]);self.restoreBackup();return!sorted?unique_set:unique_set.sort(!sortFn?function(a,b){return a-b}:sortFn)};self.frequency=function(item){var counter=0;var arr=_array;for(var i=0,max=arr.length;i<max;i++)if(item==arr[i])counter++;return counter};self.topItem=function(){var array=_array.slice();array.sort();var max_freq=self.frequency(array[0]);var max_item=array[0];for(var i=0,max=array.length;i<max;i++)if(self.frequency(array[i])>max_freq){max_freq=self.frequency(array[i]);max_item=array[i]}return max_item};self.logKeys=function(){console.log("Now every time you press a key its keycode will be saved in the array you specified");function key(e){_array.push(e.which||e.keyCode);self.length=_array.length;updateProps(false,true)}if(isJqueryPresent)$(window).keypress(key);else window.addEventListener("keypress",key);return self};self.filter=function(callback){return _array.filter(callback)};self.getArray=function(){return _array};self.getLastItem=function(){var ar=_array;return!_array?ar[ar.length-1]:null};self.replaceArray=function(newArray,byVal){backup();_array=byVal?newArray.slice():newArray;updateLength(_array);updateProps();return _array};self.backupArray=function(){backup()};self.restoreBackup=function(){updateLength(_array);self.replaceArray(_backup.slice());updateProps();return _array};self.getBackup=function(){return _backup};self.deleteArray=function(){backup();updateProps(true);_array.length=self.length=0};self.shuffle=function(){if(!self.isEmpty()){backup();shuffle(_array);if(_backup!=_array)updateProps()}else throw new Error("Array is empty")};self.pickRandomItem=function(){return shuffle(_array.slice())[0]};self.swap=function(start_index,end_index){var array_max=self.length;if(start_index==array_max||end_index==array_max||start_index<0||end_index<0)throw new TypeError("Index out of bounds");if(!start_index||!end_index){var msg;if(start_index==0||end_index==0)msg=null;else if(!start_index&&!end_index)msg="Both indexes are invalid";else if(!start_index)msg="Start index is invalid";else msg="End index is invalid";if(msg)throw new TypeError(msg)}backup();temp=self[end_index];self[end_index]=self[start_index];self[start_index]=temp;temp=_array[end_index];_array[end_index]=_array[start_index];_array[start_index]=temp};self.replaceItem=function(item_index,newObj){backup();_array[item_index]=newObj;updateProps();return _array};self.update=function(){if(!byVal)if(arr.length!=self.length||arr!=_array){self.length=arr.length;updateProps()}};self.autoUpdate=function(interval){if(isNaN(interval))throw new TypeError("Interval value must be a valid number");self.interval=setInterval(function(){self.update();console.log("Array updated")},interval<0?-interval:interval)};self.disableAutoUpdate=function(){clearInterval(self.interval)};self.lastItem=function(){return _array[self.length-1]};self.removeDuplicates=function(){var arr=_array.slice();backup();arr=self.getUniqueItems();self.replaceArray(arr)};self.push=function(){self.length=Array.prototype.push.apply(_array,getArgs(arguments));updateProps(false,true);return self.length};self.pop=function(){self.length--;var item=_array.pop();updateProps(false,true);delete self[self.length];return item};self.fill=function(){Array.prototype.fill.apply(_array,getArgs(arguments));updateProps();return _array};self.slice=function(start,stop){return Array.prototype.slice.apply(_array,getArgs(arguments))};self.shift=function(){backup();var item=_array.shift();updateLength(_array);updateProps();delete self[self.length];return item};self.unshift=function(item){_array.unshift(item);updateLength(_array);updateProps();return self.length};self.reverse=function(){backup();_array.reverse();updateProps();return _array};self.reduce=function(filter){return _array.reduce(filter)};self.sort=function(compareFunction){var fn=compareFunction==">"?function(a,b){return b-a}:compareFunction=="<"?function(a,b){return a-b}:!compareFunction?function(a,b){return a-b}:compareFunction;_array.sort(fn);updateProps();return _array};self.join=function(seperator){return _array.join(seperator)};self.toString=function(){return _array.toString()};self.indexOf=function(item){return _array.indexOf(item)};self.lastIndexOf=function(item){return _array.lastIndexOf(item)};self.keys=function(){return _array.keys()};self.map=function(fn){backup();_array.map(fn);if(_backup!=_array)updateProps()}}